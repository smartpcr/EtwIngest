# Test workflow with container containing subflow nodes
workflowId: test-container-subflows
workflowName: Test Container with Subflow Children
description: Tests container node with subflow child nodes

nodes:
  - nodeId: start
    nodeName: Start Node
    runtimeType: CSharpTask
    scriptContent: "SetOutput(\"started\", true);"

  - nodeId: deployment-container
    nodeName: Deployment Container
    runtimeType: Container
    ExecutionMode: "Parallel"
    ChildNodes:
      - nodeId: deploy-region1
        nodeName: Deploy Region 1
        runtimeType: Subflow
        WorkflowFilePath: "./deploy-region.yaml"
        InputMappings:
          region: "region1"
        OutputMappings:
          status: "region1Status"
          deploymentId: "region1DeploymentId"

      - nodeId: deploy-region2
        nodeName: Deploy Region 2
        runtimeType: Subflow
        WorkflowFilePath: "./deploy-region.yaml"
        InputMappings:
          region: "region2"
        OutputMappings:
          status: "region2Status"
          deploymentId: "region2DeploymentId"

      - nodeId: deploy-region3
        nodeName: Deploy Region 3
        runtimeType: Subflow
        WorkflowFilePath: "./deploy-region.yaml"
        InputMappings:
          region: "region3"
        OutputMappings:
          status: "region3Status"
          deploymentId: "region3DeploymentId"

    ChildConnections: []

  - nodeId: finish
    nodeName: Finish Node
    runtimeType: CSharpTask
    scriptContent: "SetOutput(\"finished\", true);"

connections:
  - sourceNodeId: start
    targetNodeId: deployment-container
    triggerMessageType: Complete
    isEnabled: true

  - sourceNodeId: deployment-container
    targetNodeId: finish
    triggerMessageType: Complete
    isEnabled: true
